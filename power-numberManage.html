<!--_meta 作为公共模版分离出去-->
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<LINK rel="Bookmark" href="/favicon.ico" >
	<LINK rel="Shortcut Icon" href="/favicon.ico" />
	<!--[if lt IE 9]>
	<script type="text/javascript" src="lib/html5.js"></script>
	<script type="text/javascript" src="lib/respond.min.js"></script>
	<script type="text/javascript" src="lib/PIE_IE678.js"></script>
	<![endif]-->
	<link rel="stylesheet" type="text/css" href="static/h-ui/css/H-ui.min.css" />
	<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/H-ui.admin.css" />
	<link rel="stylesheet" type="text/css" href="lib/Hui-iconfont/1.0.7/iconfont.css" />
	<link rel="stylesheet" type="text/css" href="lib/icheck/icheck.css" />
	<link rel="stylesheet" type="text/css" href="static/h-ui.admin/skin/default/skin.css" id="skin" />
	<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/style.css" />
	<!--[if IE 6]>
	<script type="text/javascript" src="http://lib.h-ui.net/DD_belatedPNG_0.0.8a-min.js" ></script>
	<script>DD_belatedPNG.fix('*');</script>
	<![endif]-->
	<!--/meta 作为公共模版分离出去-->
	<title>文本回复编辑</title>
	<link href="lib/webuploader/0.1.5/webuploader.css" rel="stylesheet" type="text/css" />
</head>
<body>
<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 权限管理 <span class="c-gray en">&gt;</span> 账号权限分配 <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" ><i class="Hui-iconfont">&#xe68f;</i></a></nav>
<marquee behavior="" direction="" class="c-red">系统将于2016年10月10日18：00一2016年10月11日6：00维护升级，如有不便敬请谅解！！</marquee>
<div class="page-container">
	<form class="form form-horizontal demoform" id="form-article-add">
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">所属公司：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<span class="c-succes">中国人民财产保险股份有限公司 <img style="width:29px;height: 13px" src="temp/brand/u1602.png" alt=""></span>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">用户账号：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input style="width: 600px" type="text" class="input-text" value="" placeholder="" id="b" name="">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">密码：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input style="width: 600px" type="password" class="input-text" value="" placeholder="密码范围在6~15位之间！" id="" name="userpassword" datatype="*6-15">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">确认密码：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input style="width: 600px" type="password" reCheck="userpassword" class="input-text" value="" placeholder="两次输入的密码必须一致！" id="password" datatype="*6-15" name="userpassword">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2"><span class="c-red"> （非必选） </span> 权限分配：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<div class="select-box" style="width: 600px">
					<select class="select" size="1" name="demo1">
						<option value="不选" selected> 不选 </option>
						<option value="全国"> 全国 </option>
						<option value="华东区域"> 华东区域 </option>
						<option value="华南区域"> 华南区域 </option>
						<option value="华中区域"> 华中区域 </option>
						<option value="华北区域"> 华北区域 </option>
						<option value="西南区域"> 西南区域 </option>
						<option value="东北区域"> 东北区域 </option>
						<option value="港澳台区域"> 港澳台区域 </option>
					</select>
				</div>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">归属省市区：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<div id="province"></div>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">归属品牌：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<div class="select-box" style="width: 600px">
					<select class="select" size="1" name="demo1">
						<option value="品牌" selected> 品牌 </option>
						<option value="所有" selected> 所有 </option>
						<option value="奥迪" selected> 奥迪 </option>
						<option value="奔驰" selected> 奔驰 </option>
						<option value="宝马" selected> 宝马 </option>
						<option value="大众" selected> 大众 </option>
					</select>
				</div>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">归属渠道：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<div class="select-box" style="width: 600px">
					<select class="select" size="1" name="demo1">
						<option value="所有" selected> 所有 </option>
						<option value="安洋伟业" selected> 安洋伟业 </option>
						<option value="亚之杰" selected> 亚之杰 </option>
					</select>
				</div>
				<span class="c-red" style="white-space:nowrap;overflow: hidden;text-overflow :ellipsis;">下拉列表选定后，渠道信息自动显示出来（每个渠道信息用单独方块做背景分开;2个以上需标记序号）</span>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">渠道信息：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<textarea id="power-textarea" name="" cols="" rows="" class="textarea"  dragonfly="true" nullmsg="备注不能为空！" onKeyUp="textarealength(this,200)" style="width: 600px"></textarea>
				<p class="textarea-numberbar"><em class="textarea-length">0</em>/200</p>
			</div>
		</div>
		<div class="row cl">
			<div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-2">
				<button onClick="article_save();" class="btn btn-secondary radius" type="button"><i class="Hui-iconfont">&#xe604;</i> 确认提交 </button>
			</div>
		</div>
	</form>
	<div class="mt-20">
		<div class="Huialert Huialert-success text-r">
			<a style="text-decoration:none" class="btn btn-primary radius" onClick="saveAsExcel('tableid')" href="javascript:;" title="导出"> 导出Excel </a>
		</div>
		<table id="tableid" class="table table-border table-bordered table-bg table-hover table-sort">
			<thead>
			<tr class="text-c">
				<th>序号</th>
				<th>账号</th>
				<th>密码</th>
				<th>权限区域</th>
				<th>品牌</th>
				<th>4S店</th>
				<th>状态</th>
				<th>修改</th>
				<th>备注</th>
			</tr>
			</thead>
			<tbody>
			<tr class="text-c">
				<td>1</td>
				<td class="text-c">bj123</td>
				<td class="text-c">bj123</td>
				<td class="text-c">华北区域</td>
				<td class="text-c">所有</td>
				<td class="text-c">所有</td>
				<td class="text-c"><span class="label label-success radius">√</span></td>
				<td class="td-manage">
					<a style="text-decoration:none" class="ml-5" onClick="picture_edit('编辑','basis-picAdd.html','10001')" href="javascript:;" title="编辑"><i class="Hui-iconfont">&#xe6df;</i></a>
				</td>
				<td class="text-c"></td>
			</tr>
			<tr class="text-c">
				<td>2</td>
				<td class="text-c">bj123</td>
				<td class="text-c">bj123</td>
				<td class="text-c">华北区域</td>
				<td class="text-c">所有</td>
				<td class="text-c">所有</td>
				<td class="text-c"><span class="label label-success radius">√</span></td>
				<td class="td-manage">
					<a style="text-decoration:none" class="ml-5" onClick="picture_edit('编辑','basis-picAdd.html','10001')" href="javascript:;" title="编辑"><i class="Hui-iconfont">&#xe6df;</i></a>
				</td>
				<td class="text-c"></td>
			</tr>
			<tr class="text-c">
				<td>3</td>
				<td class="text-c">bj123</td>
				<td class="text-c">bj123</td>
				<td class="text-c">华北区域</td>
				<td class="text-c">所有</td>
				<td class="text-c">所有</td>
				<td class="text-c"><span class="label label-danger radius">×</span></td>
				<td class="td-manage">
					<a style="text-decoration:none" class="ml-5" onClick="picture_edit('编辑','basis-picAdd.html','10001')" href="javascript:;" title="编辑"><i class="Hui-iconfont">&#xe6df;</i></a>
				</td>
				<td class="text-c"></td>
			</tr>
			</tbody>
		</table>
	</div>

</div>
</div>
<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="lib/layer/2.1/layer.js"></script>
<script type="text/javascript" src="lib/icheck/jquery.icheck.min.js"></script>
<script type="text/javascript" src="lib/jquery.validation/1.14.0/jquery.validate.min.js"></script>
<script type="text/javascript" src="lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="lib/jquery.validation/1.14.0/messages_zh.min.js"></script>
<script type="text/javascript" src="lib/My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript" src="lib/datatables/1.10.0/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="static/h-ui/js/H-ui.js"></script>
<script type="text/javascript" src="static/h-ui.admin/js/H-ui.admin.js"></script>
<script type="text/javascript" src="static/h-ui.admin/js/comment.js"></script>
<!--/_footer /作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="lib/webuploader/0.1.5/webuploader.min.js"></script>
<script type="text/javascript" src="lib/ueditor/1.4.3/ueditor.config.js"></script>
<script type="text/javascript" src="lib/ueditor/1.4.3/ueditor.all.min.js"> </script>
<script type="text/javascript" src="lib/ueditor/1.4.3/lang/zh-cn/zh-cn.js"></script>
<!--表单验证-->
<script type="text/javascript" src="Validform/Validform.js"></script>
<!--城市三级联动-->
<script type="text/javascript" src="city-three/jquery.provincesCity.js"></script>
<script type="text/javascript" src="city-three/provincesData.js"></script>
<script type="text/javascript">
    function article_save(){
        window.parent.location.reload();
    }
	/*城市三级联动*/
    $(function(){
        $("#province").ProvinceCity();
        $("#province").children("select").css("width","200");
        $("#province").children("select").attr("class","input-text");
        $('.table-sort').dataTable({
            "aaSorting": [[ 0, "desc" ]],//默认第几个排序
            "bStateSave": true,//状态保存
            "aoColumnDefs": [
                //{"bVisible": false, "aTargets": [ 3 ]} //控制列的隐藏显示
                {"orderable":false,"aTargets":[1,2,3,4,5,6,7,8]}// 制定列不参与排序
            ]
        });
    /*表单验证*/
    $(function () {
        $(".demoform").Validform();
        var str="";
        str+="渠道名称：\n";
        str+="渠道地址：\n";
        str+="渠道电话：\n";
        str+="渠道负责人：\n";
        str+="负责人电话：\n";
        str+="所属部门：\n";
        str+="部门经理：\n";
        str+="经理电话：\n";
        $("#power-textarea").val(str);
    })
    });
    /*删除*/
    function picture_del(obj,id){
        layer.confirm('确认要删除吗？',function(index){
            $(obj).parents("tr").remove();
            layer.msg('已删除!',{icon:1,time:3000});
        });
    }
	/*导出表格*/
    function saveAsExcel(tableID) {
        var tb = new TableToExcel(tableid);
        tb.setFontStyle("Courier New");
        tb.setFontSize(10);
        tb.setTableBorder(2);
        tb.setColumnWidth(7);
        tb.isLineWrap(true);
        tb.getExcelFile();
    }
    function TableToExcel(tableID) {
        this.tableBorder = -1; //边框类型，-1没有边框 可取1/2/3/4
        this.backGround = 0; //背景颜色：白色 可取调色板中的颜色编号 1/2/3/4....
        this.fontColor = 1; //字体颜色：黑色
        this.fontSize = 10; //字体大小
        this.fontStyle = "宋体"; //字体类型
        this.rowHeight = -1; //行高
        this.columnWidth = -1; //列宽
        this.lineWrap = true; //是否自动换行
        this.textAlign = -4108; //内容对齐方式 默认为居中
        this.autoFit = false; //是否自适应宽度
        this.tableID = tableID;
    }
    TableToExcel.prototype.setTableBorder = function (excelBorder) {
        this.tableBorder = excelBorder;
    };
    TableToExcel.prototype.setBackGround = function (excelColor) {
        this.backGround = excelColor;
    };
    TableToExcel.prototype.setFontColor = function (excelColor) {
        this.fontColor = excelColor;
    };
    TableToExcel.prototype.setFontSize = function (excelFontSize) {
        this.fontSize = excelFontSize;
    };
    TableToExcel.prototype.setFontStyle = function (excelFont) {
        this.fontStyle = excelFont;
    };
    TableToExcel.prototype.setRowHeight = function (excelRowHeight) {
        this.rowHeight = excelRowHeight;
    };
    TableToExcel.prototype.setColumnWidth = function (excelColumnWidth) {
        this.columnWidth = excelColumnWidth;
    };
    TableToExcel.prototype.isLineWrap = function (lineWrap) {
        if (lineWrap == false || lineWrap == true) {
            this.lineWrap = lineWrap;
        }
    };
    TableToExcel.prototype.setTextAlign = function (textAlign) {
        this.textAlign = textAlign;
    };
    TableToExcel.prototype.isAutoFit = function (autoFit) {
        if (autoFit == true || autoFit == false)
            this.autoFit = autoFit;
    }
    //文件转换主函数
    TableToExcel.prototype.getExcelFile = function () {
        var jXls, myWorkbook, myWorksheet, myHTMLTableCell, myExcelCell, myExcelCell2;
        var myCellColSpan, myCellRowSpan;

        try {
            jXls = new ActiveXObject('Excel.Application');
        }
        catch (e) {
            alert("无法启动Excel!\n\n" + e.message +
                "\n\n如果您确信您的电脑中已经安装了Excel，" +
                "那么请调整IE的安全级别。\n\n具体操作：\n\n" +
                "工具 → Internet选项 → 安全 → 自定义级别 → 对没有标记为安全的ActiveX进行初始化和脚本运行 → 启用");
            return false;
        }

        jXls.Visible = true;
        myWorkbook = jXls.Workbooks.Add();
        jXls.DisplayAlerts = false;
        myWorkbook.Worksheets(3).Delete();
        myWorkbook.Worksheets(2).Delete();
        jXls.DisplayAlerts = true;
        myWorksheet = myWorkbook.ActiveSheet;

        var readRow = 0, readCol = 0;
        var totalRow = 0, totalCol = 0;
        var tabNum = 0;

        //设置行高、列宽
        if (this.columnWidth != -1)
            myWorksheet.Columns.ColumnWidth = this.columnWidth;
        else
            myWorksheet.Columns.ColumnWidth = 7;
        if (this.rowHeight != -1)
            myWorksheet.Rows.RowHeight = this.rowHeight;

        //搜索需要转换的Table对象，获取对应行、列数
        var obj = document.all.tags("table");
        for (x = 0; x < obj.length; x++) {
            if (obj[x].id == this.tableID) {
                tabNum = x;
                totalRow = obj[x].rows.length;
                for (i = 0; i < obj[x].rows[0].cells.length; i++) {
                    myHTMLTableCell = obj[x].rows(0).cells(i);
                    myCellColSpan = myHTMLTableCell.colSpan;
                    totalCol = totalCol + myCellColSpan;
                }
            }
        }

        //开始构件模拟表格
        var excelTable = new Array();
        for (i = 0; i <= totalRow; i++) {
            excelTable[i] = new Array();
            for (t = 0; t <= totalCol; t++) {
                excelTable[i][t] = false;
            }
        }

        //开始转换表格
        for (z = 0; z < obj[tabNum].rows.length; z++) {
            readRow = z + 1;
            readCol = 0;
            for (c = 0; c < obj[tabNum].rows(z).cells.length; c++) {
                myHTMLTableCell = obj[tabNum].rows(z).cells(c);
                myCellColSpan = myHTMLTableCell.colSpan;
                myCellRowSpan = myHTMLTableCell.rowSpan;
                for (y = 1; y <= totalCol; y++) {
                    if (excelTable[readRow][y] == false) {
                        readCol = y;
                        break;
                    }
                }
                if (myCellColSpan * myCellRowSpan > 1) {
                    myExcelCell = myWorksheet.Cells(readRow, readCol);
                    myExcelCell2 = myWorksheet.Cells(readRow + myCellRowSpan - 1, readCol + myCellColSpan - 1);
                    myWorksheet.Range(myExcelCell, myExcelCell2).Merge();
                    myExcelCell.HorizontalAlignment = this.textAlign;
                    myExcelCell.Font.Size = this.fontSize;
                    myExcelCell.Font.Name = this.fontStyle;
                    myExcelCell.wrapText = this.lineWrap;
                    myExcelCell.Interior.ColorIndex = this.backGround;
                    myExcelCell.Font.ColorIndex = this.fontColor;
                    if (this.tableBorder != -1) {
                        myWorksheet.Range(myExcelCell, myExcelCell2).Borders(1).Weight = this.tableBorder;
                        myWorksheet.Range(myExcelCell, myExcelCell2).Borders(2).Weight = this.tableBorder;
                        myWorksheet.Range(myExcelCell, myExcelCell2).Borders(3).Weight = this.tableBorder;
                        myWorksheet.Range(myExcelCell, myExcelCell2).Borders(4).Weight = this.tableBorder;
                    }

                    myExcelCell.Value = myHTMLTableCell.innerText;
                    for (row = readRow; row <= myCellRowSpan + readRow - 1; row++) {
                        for (col = readCol; col <= myCellColSpan + readCol - 1; col++) {
                            excelTable[row][col] = true;
                        }
                    }

                    readCol = readCol + myCellColSpan;
                } else {
                    myExcelCell = myWorksheet.Cells(readRow, readCol);
                    myExcelCell.Value = myHTMLTableCell.innerText;
                    myExcelCell.HorizontalAlignment = this.textAlign;
                    myExcelCell.Font.Size = this.fontSize;
                    myExcelCell.Font.Name = this.fontStyle;
                    myExcelCell.wrapText = this.lineWrap;
                    myExcelCell.Interior.ColorIndex = this.backGround;
                    myExcelCell.Font.ColorIndex = this.fontColor;
                    if (this.tableBorder != -1) {
                        myExcelCell.Borders(1).Weight = this.tableBorder;
                        myExcelCell.Borders(2).Weight = this.tableBorder;
                        myExcelCell.Borders(3).Weight = this.tableBorder;
                        myExcelCell.Borders(4).Weight = this.tableBorder;
                    }
                    excelTable[readRow][readCol] = true;
                    readCol = readCol + 1;
                }
            }
        }
        if (this.autoFit == true)
            myWorksheet.Columns.AutoFit;
        jXls.UserControl = true;
        jXls = null;
        myWorkbook = null;
        myWorksheet = null;
    };
</script>
</body>
</html>